<!DOCTYPE html>
<html lang="en">
<head>
    <title>CountdownTimer</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <svg id="progressBarContainer"width="144" height="300">
            <defs>
                <pattern id="pattern1"x="0"y="0"width="12"height="12"patternUnits="userSpaceOnUse">
                    <circle cx="5"cy="5"r="3"stroke="0"fill=white />

                </pattern>
            </defs>
            <rect id="progressBar" x="0" y="0"width="144"height="300"style="fill:url(#pattern1)"/>
        </svg>
        <div id="clock">
            <p>Ready!</p>
        </div>

        <div id="content">
            <select class="selector" id="hours">
                <option value="0">0 hours</option>
                <option value="1">1 hours</option>
                <option value="2">2 hours</option>
                <option value="3">3 hours</option>
                <option value="4">4 hours</option>
                <option value="5">5 hours</option>
                <option value="6">6 hours</option>
                <option value="7">7 hous</option>
                <option value="8">8 hours</option>
                <option value="9">9 hours</option>
                <option value="10">10 hours</option>
                <option value="11">11 hours</option>
                <option value="12">12 hours</option>
                <option value="13">13 hours</option>
                <option value="14">14 hours</option>
                <option value="15">15 hours</option>
                <option value="16">16 hours</option>
                <option value="17">17 hours</option>
                <option value="18">18 hours</option>
                <option value="19">19 hours</option>
                <option value="20">20 hours</option>
                <option value="21">21 hours</option>
                <option value="22">22 hours</option>
                <option value="23">23 hours</option>
            </select>
            <select class="selector" id="minutes">
                <option value="0">0 min</option>
                <option value="1">1min</option>
                <option value="2">2min</option>
                <option value="3">3min</option>
                <option value="4">4min</option>
                <option value="5">5min</option>
                <option value="6">6min</option>
                <option value="7">7min</option>
                <option value="8">8min</option>
                <option value="9">9min</option>
                <option value="10">10min</option>
                <option value="11">11min</option>
                <option value="12">12min</option>
                <option value="13">13min</option>
                <option value="14">14min</option>
                <option value="15">15min</option>
                <option value="16">16min</option>
                <option value="17">17min</option>
                <option value="18">18min</option>
                <option value="19">19min</option>
                <option value="20">20min</option>
                <option value="21">21min</option>
                <option value="22">22min</option>
                <option value="23">23min</option>
                <option value="24">24min</option>
                <option value="25">25min</option>
                <option value="26">26min</option>
                <option value="27">27min</option>
                <option value="28">28min</option>
                <option value="29">29min</option>
                <option value="30">30min</option>
                <option value="31">31min</option>
                <option value="32">32min</option>
                <option value="33">33min</option>
                <option value="34">34min</option>
                <option value="35">35min</option>
                <option value="36">36min</option>
                <option value="37">37min</option>
                <option value="38">38min</option>
                <option value="39">39min</option>
                <option value="40">40min</option>
                <option value="41">41min</option>
                <option value="42">42min</option>
                <option value="43">43min</option>
                <option value="44">44min</option>
                <option value="45">45min</option>
                <option value="46">46min</option>
                <option value="47">47min</option>
                <option value="48">48min</option>
                <option value="49">49min</option>
                <option value="50">50min</option>
                <option value="51">51min</option>
                <option value="52">52min</option>
                <option value="53">53min</option>
                <option value="54">54min</option>
                <option value="55">55min</option>
                <option value="56">56min</option>
                <option value="57">57min</option>
                <option value="58">58min</option>
                <option value="59">59min</option>
            </select>

            <select class="selector" id="seconds">
              <option value="0">0sec</option>
              <option value="1">1sec</option>
              <option value="2">2sec</option>
              <option value="3">3sec</option>
              <option value="4">4sec</option>
              <option value="5">5sec</option>
              <option value="6">6sec</option>
              <option value="7">7sec</option>
              <option value="8">8sec</option>
              <option value="9">9sec</option>
              <option value="10">10sec</option>
              <option value="11">11sec</option>
              <option value="12">12sec</option>
              <option value="13">13sec</option>
              <option value="14">14sec</option>
              <option value="15">15sec</option>
              <option value="16">16sec</option>
              <option value="17">17sec</option>
              <option value="18">18sec</option>
              <option value="19">19sec</option>
              <option value="20">20sec</option>
              <option value="21">21sec</option>
              <option value="22">22sec</option>
              <option value="23">23sec</option>
              <option value="24">24sec</option>
              <option value="25">25sec</option>
              <option value="26">26sec</option>
              <option value="27">27sec</option>
              <option value="28">28sec</option>
              <option value="29">29sec</option>
              <option value="30">30sec</option>
              <option value="31">31sec</option>
              <option value="32">32sec</option>
              <option value="33">33sec</option>
              <option value="34">34sec</option>
              <option value="35">35sec</option>
              <option value="36">36sec</option>
              <option value="37">37sec</option>
              <option value="38">38sec</option>
              <option value="39">39sec</option>
              <option value="40">40sec</option>
              <option value="41">41sec</option>
              <option value="42">42sec</option>
              <option value="43">43sec</option>
              <option value="44">44sec</option>
              <option value="45">45sec</option>
              <option value="46">46sec</option>
              <option value="47">47sec</option>
              <option value="48">48sec</option>
              <option value="49">49sec</option>
              <option value="50">50sec</option>
              <option value="51">51sec</option>
              <option value="52">52sec</option>
              <option value="53">53sec</option>
              <option value="54">54sec</option>
              <option value="55">55sec</option>
              <option value="56">56sec</option>
              <option value="57">57sec</option>
              <option value="58">58sec</option>
              <option value="59">59sec</option>
            </select>

        </div>
        <div class="buttonSection">
            <div class="button1">
                <button class="roundButton"id="start">start</button>
            </div>
            <div class="button2">
                <button class="roundButton"id="cancel">Cancel</button>
            </div>
        </div>

    </div>

    <script>
        
        document.getElementById("start").addEventListener(`click`,startTimer);
        document.getElementById("cancel").addEventListener(`click`,cancelledButtonPressed);

        var startTime;
        var endTime;
        var origiTimePeriod;
        var newTimePeriod;
        var timer;
        var cancelled = false;

        function startTimer() {
            cancelled = false;
            startTime = new Date ();
            endTime = getEndTime ();

            origiTimePeriod = endTime.getTime() - startTime.getTime();

            newTimePeriod= origiTimePeriod;

            timer = setInterval(displayCountdown,1000);
            
        }

        function displayCountdown(){
  
            var timeleft = msToTime(newTimePeriod);
           
            document.getElementById("clock").innerHTML = `<p> ${timeleft["hours"]}h ${timeleft["minutes"]}m ${timeleft["seconds"]}s</p>`;
           
            var newHeight = Math.floor(newTimePeriod / origiTimePeriod * 100) * 3;
            document.getElementById("progressBar").setAttribute("height",newHeight);
            
            newTimePeriod -= 1000;

            if(newTimePeriod<0 ||cancelled){
                clearInterval(timer);
                document.getElementById("clock").innerHTML= "<p> Complete!! </p>";
            }       
        }
        function cancelledButtonPressed(){
            cancelled= true;
        }
        function msToTime(milliseconds) {
            var mHour = 1000*60*60;
            var mMinute = 1000*60;
            var mSecond = 1000;

            var hours = Math.floor(milliseconds/mHour);
            var minutes = Math.floor((milliseconds% mHour) / mMinute);
            var seconds = Math.floor((milliseconds % mMinute) / mSecond);

            var time = []
            time["hours"] = hours;
            time["minutes"]= minutes;
            time["seconds"]= seconds;

            return time ;
        }

        function getEndTime(){
            var dt = new Date();

            var hours = parseInt(document.getElementById("hours").value);
            var minutes = parseInt(document.getElementById("minutes").value);
            var seconds = parseInt(document.getElementById("seconds").value);

            dt.setHours(dt.getHours()+ hours);
            dt.setMinutes(dt.getMinutes()+ minutes);
            dt.getSeconds(dt.getSeconds()+ seconds);

            return dt;
        }

    </script>
</body>
</html>